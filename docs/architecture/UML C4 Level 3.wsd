@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Component.puml

LAYOUT_WITH_LEGEND()

Container(webServer, "Webserver Backend", "Kotlin", "Handles business logic, data storage, and retrieval for the mobile logbook system.")

Component(authService, "Authentication Service", "Kotlin", "Handles pilot authentication and session management.")
Component(logbookMgr, "Logbook Manager", "Kotlin", "Manages creation, update, and retrieval of logbook entries.")
Component(pilotMgr, "Pilot Manager", "Kotlin", "Handles pilot account registration, updates, and deactivation.")
Component(weatherServiceIntegrator, "Weather Service Integrator", "Kotlin", "Integrates real-time weather data into logbook entries.")
Component(dataSync, "Data Synchronization Service", "Kotlin", "Ensures data consistency between mobile and server.")
Component(apiGateway, "API Gateway", "Kotlin", "Central endpoint for frontend-backend communication, routes requests.")
Component(databaseInterface, "Database Interface", "Kotlin", "Abstracts database operations, ensuring loose coupling.")
Component(notificationService, "Notification Service", "Kotlin", "Manages sending notifications to pilots.")

ContainerDb(db, "Logbook Database", "SQL Database", "Stores pilots, flights, and weather data.")
Container_Ext(weatherAPI, "Weather API", "External Service", "Provides weather data.")

Rel_R(apiGateway, authService, "Delegates authentication and authorization")
Rel_U(apiGateway, pilotMgr, "Routes pilot management requests")
Rel_U(apiGateway, logbookMgr, "Routes logbook entry requests")
Rel_U(apiGateway, weatherServiceIntegrator, "Routes weather data requests")
Rel_U(apiGateway, dataSync, "Handles data synchronization requests")
Rel_U(apiGateway, notificationService, "Triggers notifications")
Rel_L(pilotMgr, databaseInterface, "Uses")
Rel_L(logbookMgr, databaseInterface, "Uses")
Rel_L(weatherServiceIntegrator, weatherAPI, "Fetches weather data")
Rel_L(dataSync, databaseInterface, "Synchronizes data")
Rel(databaseInterface, db, "Reads from and writes to", "SQL/JDBC")
Rel_U(notificationService, pilotMgr, "Notifies pilots", "Email/SMS")

@enduml
